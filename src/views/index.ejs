<!DOCTYPE html>
<html>
<head>
	<title>Home</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
	<script src='https://kit.fontawesome.com/a076d05399.js'></script>
	<link rel="stylesheet" href="css/stylesPeer.css">
	<link rel="stylesheet" href="/css/styles.min.css">
</head>
<body>
	<!--<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container-fluid">
		  <div class="navbar-header">
			<a class="navbar-brand" href="#">WebSiteName</a>
		  </div>
		  <ul class="nav navbar-nav">
			<li id="allUsers"><a href="#">Users</a></li>
		  </ul>
		  <ul class="nav navbar-nav navbar-right">
			<li><a href="#"><span class="glyphicon glyphicon-user" ></span><%= userName%></a></li>
		  </ul>
		</div>
	</nav>-->
	<%- include('supportingLayouts/navbar', {condition, nameOfUser: userName}); -%>
	<div class="container" style="margin-top:10px">
		<div class="row">
			<div class="col-sm-2" id="sidebar">
				<h3 > Your chats</h3>
				<% if (chatsUser.length > 0) { %>
					<ul class="users">
						<% chatsUser.forEach(function(chat){ %>
							<li onclick="startChat('<%=chat.id %>')"><%=chat.name %></li>
						<% }); %>
					</ul>
				<% } else {%>
					<h4>You havn't any chat yet.</h4>
				<% } %>
			</div>
			<div class="col-sm-10" id="mainDiv">

			</div>
			<!-- <div class="col-sm-3" id="chatSingle">

			</div> -->
		</div>

	</div>

	<script id='sidebar-template' type="text/html">
		<h3 class="list-title"> Your chats</h3>
		<ul class="users">
			{{#users}}
				<li onclick="startChat('{{_id}}')">{{name}}</li>
			{{/users}}
		</ul>
	</script>
	<script id="message-template" type="text/html">
		<div class="message">
			<p>
				<span class="message__name">{{username}}</span>
				<span class="message__meta">{{createdAt}}</span>
			</p>
			<p>{{message}}</p>    
		</div>
	</script>
	<script id="chat-template" type="text/html">
		<div id="{{id}}" class="chat__main" >
			<div id="messages" class="chat__messages">
			</div>
			
			<div class="compose">
				<form id='message-form'>
					<input name="message" placeholder="Your message" required autocomplete="off" >
					<button>Send</button>
				</form>
			</div>
		</div>
	</script>

	<script id="video_call_tamplate" type="text/html">
		<div id="videos">
			<video id="self-view" autoplay muted="muted"></video>
			<video id="remote-view" autoplay></video>
		</div>
		<button id="offer">Send offer</button>
		<button id="answer">Send answer</button>
		<button id="leaveCall">Leave call</button>
	</script>

	<script id="users-list-tamplate" type="text/html">
		<h2>Users list</h2>          
  	<table class="table table-hover">
    	<thead>
		<tr>
			<th>Username</th>
			<th>Name</th>
			<th>Email</th>
			<th>Push Notification</th>
			<th>Start chat</th>
			<th>Start video call</th>
		</tr>
		</thead>
		<tbody>
			{{#data}}
		<tr>
			<td>{{username}}</td>
			<td>{{name}}</td>
			<td>{{email}}</td>
			<td onclick="sendPushNotification('{{_id}}')">Send Push Notification</td>
			<td onclick="startChat('{{_id}}')"><i class='far fa-comment-dots' style='font-size:24px'></i></td>
			<td onclick="startVideoCall('{{_id}}')"><i class='fas fa-video' style='font-size:24px'></i></td>
		</tr>
			{{/data}}
		</tbody>
	</table>
	</script>

	<script id="video-incoming" type="text/html">
		<h2>Video call</h2>          
		<video autoplay></video>
		
		<script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
	</script>

	<script src="/socket.io/socket.io.js"></script>
    <script src="/js/index.js"></script>
	

<script src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/3.0.1/mustache.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
    
</body>
</html>